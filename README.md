I'll clean and optimize this later.